---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

```{r}
activity <- read.csv("activity.csv",stringsAsFactors=F)
activity$date <- as.Date(activity$date)
#activity$interval <- strptime(activity$interval,format = "%H:%M")
activity$interval <- paste(as.integer(activity$interval/100),activity$interval%%100,sep = ":")
activity$interval <- paste(activity$date,activity$interval,sep = " ")
head(activity)
```


## What is mean total number of steps taken per day?
```{r}
stepsPerDay <- aggregate(steps~date,activity,sum)
hist(stepsPerDay$steps,xlab = "Total number of steps per day",breaks = nrow(stepsPerDay))
meanStepsPerDay <- aggregate(steps~date,activity,mean)
medianStepsPerDay <- aggregate(steps~date,activity,median)
meanStepsPerDay
medianStepsPerDay
```



## What is the average daily activity pattern?
```{r}
timePlot <- aggregate(steps~interval,activity,mean)
with(timePlot, plot(x = interval,y = steps,type = "l"))
timePlot[timePlot$steps== max(timePlot$steps),]
```

## Imputing missing values
```{r}
nrow(activity[is.na(activity),])
allNAs <- activity[is.na(activity$steps),]
nonNAs <- activity[!is.na(activity$steps),]
allNAs$steps[allNAs$interval==timePlot$interval] <- timePlot$steps
newActivity <- merge(allNAs,nonNAs, all = T)
stepsPerDay <- aggregate(steps~date,newActivity,sum)
hist(stepsPerDay$steps,xlab = "Total number of steps per day",breaks = nrow(stepsPerDay))
meanStepsPerDay <- aggregate(steps~date,newActivity,mean)
medianStepsPerDay <- aggregate(steps~date,newActivity,median)
meanStepsPerDay
medianStepsPerDay
```


## Are there differences in activity patterns between weekdays and weekends?
```{r}
weekDays <- weekdays(newActivity$date,abbreviate = T)
weekDayFactor <- character()
for(i in weekDays) if(i %in% c("Sat","Sun")) weekDayFactor <- c(weekDayFactor,"Weekend") else weekDayFactor <- c(weekDayFactor,"Weekday")
newActivity$weekDay <- as.factor(weekDayFactor)

newTimePlot <- aggregate(steps~interval+weekDay,newActivity,mean)
par(mfrow=c(2,1))
with(newTimePlot[newTimePlot$weekDay=="Weekend",], plot(x = interval,y = steps,type = "l",main = "weekend",ylab = "Number of steps"))
with(newTimePlot[newTimePlot$weekDay=="Weekday",], plot(x = interval,y = steps,type = "l",main="weekday",ylab = "Number of steps"))
```

